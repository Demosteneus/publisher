<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../css/normal.css" type="text/css" />
<link rel="stylesheet" href="../css/pygments.css" type="text/css" />
<link rel="stylesheet" href="../css/colorbox.css" type="text/css" />
<script src="../javascript/jquery.min.js" ></script>
<script src="../javascript/jquery.colorbox-min.js" ></script>
<script>
  $(document).ready(function(){
     $(".figure").colorbox({ rel: 'group1', opacity:0.5 });
  });
</script>
<title>Qualitätssicherung</title>
</head>
<body>
<div id="logo"><a href="../index-de.html"><img src="../images/publisher_logo.png" alt="Startseite"></a></div>
	<h1>Qualitätssicherung und <span class="caps">PDF</span> Vergleich</h1>
<p>Um zu gewährleisten, dass neue Versionen des Publishers auch exakt dieselben Ergebnisse liefern wie vorhergehende, hat der Publisher eine Funktionalität eingebaut, mit der man unerwünschte Verhaltensänderungen erkennen kann.</p>
<p>Die Idee ist folgende: ausgehend von einer Layout-Datei und einem überprüften Ergebnis (Referenz <span class="caps">PDF</span>) kann der Publisher kontrollieren, ob mit der aktuellen Version noch immer dasselbe Ergebnis erzielt wird. Dazu erstellt man eine Layoutdatei und Datendatei im <span class="caps">XML</span> Format, lässt eine <span class="caps">PDF</span> Datei daraus erzeugen und speichert diese unter dem Namen <code>reference.pdf</code> ab. Bei dem Aufruf von <code>sp compare &lt;Verzeichnis&gt;</code>  wird nun der Publisher erneut aufgerufen und prüft visuell, Seite für Seite, ob die resultierende Datei mit der vorher angelegten <span class="caps">PDF</span> Datei <code>reference.pdf</code> übereinstimmt.</p>
<h2>Voraussetzungen für den Vergleich</h2>
<p>Der Publisher sucht rekursiv ausgehend von dem angegebenen Verzeichnis nach Verzeichnissen, die eine Datei <code>layout.xml</code> oder eine Datei <code>publisher.cfg</code> enthalten. In diesem Verzeichnis wird dann ein Publisher-Durchlauf gestartet. Die Layoutdatei muss unter dem Namen <code>layout.xml</code>, die Daten-Datei unter dem Namen <code>data.xml</code> zu finden sein, falls das nicht in der (optionalen) Datei <code>publisher.cfg</code> anders konfiguriert ist.</p>
<p>Der <span class="caps">PDF</span>-Vergleich benötigt eine Installation der kostenfreien Programmbibliothek ImageMagick, die skriptbasiert Bilder manipulieren und vergleichen kann. ImageMagick gibt es unter anderem für die Betriebssysteme Windows, Mac und Linux.</p>
<h2>Vorgehensweise</h2>
<p>Ausgehend von einer Layout und einer Datendatei erzeugt man in gewohnter Weise eine <span class="caps">PDF</span> Datei. Am einfachsten ist es, wenn sie direkt unter dem Namen <code>reference.pdf</code> erscheint.</p>
<pre>sp --jobname reference</pre>
<p>erzeugt die passende <span class="caps">PDF</span>-Datei. Mit</p>
<pre>sp --jobname reference clean</pre>
<p>löscht man die übrigen und nicht weiter benötigten Zwischendateien. Das Verzeichnis sieht nun so aus:</p>
<pre>beispiel/
├── data.xml
├── layout.xml
└── reference.pdf
 
0 directories, 3 files</pre>
<p>Wird nun <code>sp compare beispiel</code> aufgerufen, sollte es keine Beanstandung geben und als Ausgabe erscheinen:</p>
<pre>$ sp compare beispiel/
Run comparison in directory beispiel
OK
Total run time: 1.62956s</pre>
<p>Falls nun eine zukünftige Version des Publishers eine visuelle Änderung des Layouts hervorrufen würde, wäre die Ausgabe z.B. folgende:</p>
<pre>$ sp compare beispiel/
Run comparison in directory beispiel
Comparison failed. Bad pages are: [1]
Total run time: 862.898ms</pre>
<p>Die Unterschiede sind als <span class="caps">PNG</span> Dateien in dem Verzeichnis enthalten:</p>
<pre>beispiel/
├── data.xml
├── layout.xml
├── pagediff.png
├── publisher.pdf
├── reference.pdf
├── reference.png
└── source.png</pre>
<p>Die Dateien <code>source.png</code> und <code>reference.png</code> (bzw. bei mehreren Seiten mit einer Kennung für die Seitenzahl) enthalten die aktuelle Version und die Referenz als Grafik. Die Datei <code>pagediff.png</code> (auch hier mit Kennungen für die Seitenzahlen) stellt die Unterschiede zwischen den ersten beiden Dateien hervorgehoben dar. Die Gemeinsamkeiten werden abgeschwächt dargestellt.</p>
<h2>Qualitätssicherung</h2>
<p>Mit den Möglichkeiten des <span class="caps">PDF</span>-Vergleichs kann man nun eine Sammlung von Beispieldokumenten erstellen, die produktionstypisch sind. Eine Vorgehensweise besteht darin, eine Verzeichnisstruktur zu erstellen, die wie folgt aufgebaut ist:</p>
<pre>qa/
├── beispiel1
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel2
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel3
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel4
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
└── beispiel5
    ├── data.xml
    ├── layout.xml
    └── reference.pdf</pre>
<p>Mit dem Aufruf <code>sp compare qa</code> werden alle Unterverzeichnisse durchlaufen und überprüft. Im besten Fall ist die Ausgabe:</p>
<pre>$ sp compare qa/
Run comparison in directory beispiel1
OK
Run comparison in directory beispiel2
OK
Run comparison in directory beispiel3
OK
Run comparison in directory beispiel4
OK
Run comparison in directory beispiel5
OK
Total run time: 4.541458s</pre>
<div style="clear:both; border-bottom: 1px solid #a0a0a0; width: 100%"></div>
<a href="../index-de.html">Startseite</a> | <a href="../commands-de/layout.html">Befehlsreferenz</a> | Andere Sprache: <a href="../description-en/qualityassurance.html">Englisch</a> 
</body>
</html>
