<!DOCTYPE html>
<html>
<head>
    <title>Handbuch Publisher</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="alternate" type="application/atom+xml"  title="Liste der Änderungen speedata Publisher (de)"  href="../changes-de.xml" />
    <link rel="stylesheet" href="../assets/css/normal.css" type="text/css" />
    <link rel="stylesheet" href="../assets/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../assets/css/colorbox.css" type="text/css" />
    <script src="../assets/js/jquery.min.js" ></script>
    <script src="../assets/js/jquery.colorbox-min.js" ></script>
    <script>
      $(document).ready(function(){
         $(".figure").colorbox({ rel: 'group1', opacity:0.5 });
      });
    </script>
</head>
<body>
<div id="logo"><a href="../index-de.html"><img src="../assets/images/publisher_logo.png" alt="Start page"></a></div>
<div class="">
<h1>Qualitätssicherung und PDF Vergleich</h1>

<p>Um zu gewährleisten, dass neue Versionen des Publishers auch exakt
dieselben Ergebnisse liefern wie vorhergehende, hat der Publisher eine
Funktionalität eingebaut, mit der man unerwünschte Verhaltensänderungen
erkennen kann.</p>

<p>Die Idee ist folgende: ausgehend von einer Layout-Datei und einem
überprüften Ergebnis (Referenz PDF) kann der Publisher kontrollieren, ob
mit der aktuellen Version noch immer dasselbe Ergebnis erzielt wird.
Dazu erstellt man eine Layoutdatei und Datendatei im XML Format, lässt
eine PDF Datei daraus erzeugen und speichert diese unter dem Namen
<code>reference.pdf</code> ab. Bei dem Aufruf von <code>sp compare &lt;Verzeichnis&gt;</code> wird
nun der Publisher erneut aufgerufen und prüft visuell, Seite für Seite,
ob die resultierende Datei mit der vorher angelegten PDF Datei
<code>reference.pdf</code> übereinstimmt.</p>

<h2>Voraussetzungen für den Vergleich</h2>

<p>Der Publisher sucht rekursiv ausgehend von dem angegebenen Verzeichnis
nach Verzeichnissen, die eine Datei <code>layout.xml</code> oder eine Datei
<code>publisher.cfg</code> enthalten. In diesem Verzeichnis wird dann ein
Publisher-Durchlauf gestartet. Die Layoutdatei muss unter dem Namen
<code>layout.xml</code>, die Daten-Datei unter dem Namen <code>data.xml</code> zu finden sein,
falls das nicht in der (optionalen) Datei <code>publisher.cfg</code> anders
konfiguriert ist.</p>

<p>Der PDF-Vergleich benötigt eine Installation der kostenfreien
Programmbibliothek ImageMagick, die skriptbasiert Bilder manipulieren
und vergleichen kann. ImageMagick gibt es unter anderem für die
Betriebssysteme Windows, Mac und Linux.</p>

<h2>Vorgehensweise</h2>

<p>Ausgehend von einer Layout und einer Datendatei erzeugt man in gewohnter
Weise eine PDF Datei. Am einfachsten ist es, wenn sie direkt unter dem
Namen <code>reference.pdf</code> erscheint.</p>

<pre><code>sp --jobname reference
</code></pre>

<p>erzeugt die passende PDF-Datei. Mit</p>

<pre><code>sp --jobname reference clean
</code></pre>

<p>löscht man die übrigen und nicht weiter benötigten Zwischendateien. Das
Verzeichnis sieht nun so aus:</p>

<pre><code>beispiel/
├── data.xml
├── layout.xml
└── reference.pdf
 
0 directories, 3 files
</code></pre>

<p>Wird nun <code>sp compare beispiel</code> aufgerufen, sollte es keine Beanstandung
geben und als Ausgabe erscheinen:</p>

<pre><code>$ sp compare beispiel/
Total run time: 1.62956s
</code></pre>

<p>Falls nun eine zukünftige Version des Publishers eine visuelle Änderung
des Layouts hervorrufen würde, wäre die Ausgabe z.B. folgende:</p>

<pre><code>$ sp compare beispiel/
/pfad/zum/verzeichnis/beispiel
Comparison failed. Bad pages are: [0]
Max delta is 2162.760009765625
Total run time: 862.898ms
</code></pre>

<p>Die Unterschiede sind als PNG Dateien in dem Verzeichnis enthalten:</p>

<pre><code>beispiel/
├── data.xml
├── layout.xml
├── pagediff.png
├── publisher.pdf
├── reference.pdf
├── reference.png
└── source.png
</code></pre>

<p>Die Dateien <code>source.png</code> und <code>reference.png</code> (bzw. bei mehreren Seiten
mit einer Kennung für die Seitenzahl) enthalten die aktuelle Version und
die Referenz als Grafik. Die Datei <code>pagediff.png</code> (auch hier mit
Kennungen für die Seitenzahlen) stellt die Unterschiede zwischen den
ersten beiden Dateien hervorgehoben dar. Die Gemeinsamkeiten werden
abgeschwächt dargestellt.</p>

<h2>Qualitätssicherung</h2>

<p>Mit den Möglichkeiten des PDF-Vergleichs kann man nun eine Sammlung von
Beispieldokumenten erstellen, die produktionstypisch sind. Eine
Vorgehensweise besteht darin, eine Verzeichnisstruktur zu erstellen, die
wie folgt aufgebaut ist:</p>

<pre><code>qa/
├── beispiel1
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel2
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel3
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
├── beispiel4
│   ├── data.xml
│   ├── layout.xml
│   └── reference.pdf
└── beispiel5
    ├── data.xml
    ├── layout.xml
    └── reference.pdf
</code></pre>

<p>Mit dem Aufruf <code>sp compare qa</code> werden alle Unterverzeichnisse
durchlaufen und überprüft. Im besten Fall ist die Ausgabe:</p>

<pre><code>$ sp compare qa/
Total run time: 4.541458s
</code></pre>

</div>


<div style="clear:both; border-bottom: 1px solid #a0a0a0; width: 100%; margin-top: 30px;"></div>
Version: 3.1.16 | <a href="../index-de.html">Startseite</a> | <a href="../commands-de/layout.html">Elementreferenz</a> | Andere Sprache:  <a href="../description-en/qualityassurance.html">Englisch</a>

</body>
</html>